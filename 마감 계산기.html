<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ë§ˆê° ìœ„í—˜ë„ ê³„ì‚°ê¸°</title>
  <style>
    :root{
      --bg:#0b0f14;
      --bg2:#070a0f;
      --panel:#111827;
      --panel2:#0f172a;
      --tile:#0c1324;
      --text:#e5e7eb;
      --muted:#9ca3af;
      --border:#263244;
      --accent:#60a5fa;
      --good:#22c55e;
      --warn:#f59e0b;
      --bad:#ef4444;
      --chip:#0b1220;
      --shadow: 0 12px 28px rgba(0,0,0,.35);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic", Arial, sans-serif;
    
      --bg_grad1: radial-gradient(1200px 600px at 20% -10%, rgba(96,165,250,.15), transparent 60%);
      --bg_grad2: radial-gradient(900px 500px at 95% 0%, rgba(239,68,68,.10), transparent 55%);
    }

    /* ë¼ì´íŠ¸ ëª¨ë“œ: ì‘ì—… í”Œë˜ë„ˆ ëŠë‚Œ */
    [data-theme="light"]{
      --bg:#ffffff;
      --bg2:#eef2ff;
      --panel:#ffffff;
      --panel2:#f3f4f6;
      --tile:#f7f8ff;
      --text:#111827;
      --muted:#6b7280;
      --border:#e5e7eb;
      --accent:#4f46e5;
      --good:#16a34a;
      --warn:#d97706;
      --bad:#dc2626;
      --chip:#eef2ff;
      --shadow: 0 10px 22px rgba(17,24,39,.10);
    
      --bg_grad1: radial-gradient(1200px 600px at 20% -10%, rgba(37,99,235,.10), transparent 65%);
      --bg_grad2: radial-gradient(900px 500px at 95% 0%, rgba(245,158,11,.08), transparent 60%);
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 20% -10%, rgba(96,165,250,.18), transparent 60%),
        radial-gradient(900px 500px at 95% 0%, rgba(239,68,68,.10), transparent 55%),
        linear-gradient(180deg, var(--bg), var(--bg2));
    }

    .wrap{max-width: 980px; margin: 28px auto 60px; padding: 0 16px;}
    header{display:flex; align-items:flex-start; justify-content:space-between; gap:12px; margin-bottom:16px;}
    h1{font-size: 20px; margin:0; letter-spacing:-.2px;}
    .sub{margin:6px 0 0; color:var(--muted); font-size:13px; line-height:1.45;}

    .toggleRow{display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:flex-end;}
    .btn{
      border:1px solid var(--border);
      color:var(--text);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,0));
      color:var(--text);
      padding:10px 12px;
      border-radius:12px;
      cursor:pointer;
      box-shadow: var(--shadow);
      font-size:13px;
      display:inline-flex;
      gap:8px;
      align-items:center;
      font-weight:800;
    }
    [data-theme="light"] .btn{
      background: linear-gradient(180deg, rgba(255,255,255,1), rgba(255,255,255,.70));
      color: var(--text);
    }
    .btn:active{transform: translateY(1px);}
    [data-theme="light"] .btn{
      background: linear-gradient(180deg, #ffffff, #f3f4f6);
      border-color: #d1d5db;
      box-shadow: 0 8px 16px rgba(17,24,39,.08);
    }

    .grid{display:grid; grid-template-columns: 360px 1fr; gap:14px;}
    @media (max-width: 860px){ .grid{grid-template-columns:1fr;} }

    .card{
      border:1px solid var(--border);
      background: linear-gradient(180deg, var(--panel), rgba(0,0,0,0));
      border-radius: 18px;
      padding: 14px;
      box-shadow: var(--shadow);
    }
    [data-theme="light"] .card{
      background: linear-gradient(180deg, rgba(255,255,255,1), rgba(255,255,255,.85));
    }
    .card h2{margin:0 0 10px; font-size:14px; color:var(--muted); font-weight:900; letter-spacing:.2px;}

    .field{margin:10px 0;}
    label{display:block; font-size:12px; color:var(--muted); margin:0 0 6px; font-weight:800;}

    input, textarea{
      width:100%;
      border:1px solid var(--border);
      background: var(--panel2);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 12px;
      font-size: 14px;
      outline:none;
    }
    [data-theme="light"] input, [data-theme="light"] textarea{ background:#fff; }

    input:focus, textarea:focus{
      border-color: rgba(96,165,250,.55);
      box-shadow: 0 0 0 3px rgba(96,165,250,.18);
    }
    [data-theme="light"] input:focus, [data-theme="light"] textarea:focus{
      border-color: rgba(79,70,229,.45);
      box-shadow: 0 0 0 3px rgba(79,70,229,.14);
    }
    textarea{min-height: 110px; resize: vertical;}

    .hint{font-size:12px; color:var(--muted); margin-top:6px; line-height:1.45;}

    .kpi{display:grid; grid-template-columns: 1fr 1fr; gap:10px;}
    @media (max-width: 520px){ .kpi{grid-template-columns:1fr;} }

    .tile{
      border:1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(0,0,0,0));
      border-radius: 16px;
      padding: 12px;
      overflow:hidden;
    }
    [data-theme="light"] .tile{
      background: linear-gradient(180deg, rgba(99,102,241,.08), rgba(255,255,255,0));
    }

    .tile .t{font-size:12px; color:var(--muted); margin-bottom:6px; font-weight:900;}
    .tile .v{font-size:18px; font-weight:900; letter-spacing:-.3px; display:flex; align-items:baseline; gap:6px; flex-wrap:wrap;}
    .mono{font-family:var(--mono);}

    .chip{
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      background: var(--chip);
      border:1px solid var(--border);
      color: var(--text);
      display:inline-flex;
      gap:6px;
      align-items:center;
      font-weight:900;
    }
    [data-theme="light"] .chip{ background:#fff; }

    .diag{display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin-bottom:10px;}
    .dot{width:10px; height:10px; border-radius:999px; background: var(--muted); box-shadow: 0 0 0 3px rgba(0,0,0,.12);}
    [data-theme="light"] .dot{ box-shadow: 0 0 0 3px rgba(17,24,39,.06); }

    .barWrap{margin-top:10px; border:1px solid var(--border); background: var(--panel2); border-radius: 999px; overflow:hidden; height: 14px;}
    [data-theme="light"] .barWrap{ background:#fff; }
    .bar{height:100%; width:0%; background: linear-gradient(90deg, var(--accent), rgba(96,165,250,.35)); transition: width .25s ease;}

    .row2{display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:10px;}
    @media (max-width: 520px){ .row2{grid-template-columns:1fr;} }

    .small{font-size:12px; color:var(--muted); line-height:1.45; margin-top:10px;}

    .alertBox{
      border:1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(0,0,0,0));
      border-radius: 16px;
      padding: 14px;
    }
    [data-theme="light"] .alertBox{
      background: linear-gradient(180deg, rgba(245,158,11,.12), rgba(255,255,255,0));
    }
    .alertTitle{font-size:12px; font-weight:900; color:var(--muted); margin-bottom:8px;}
    .alertText{font-size:18px; font-weight:900; line-height:1.35; letter-spacing:-.2px; margin:0;}
    .alertSub{margin-top:10px; font-size:12px; color:var(--muted); line-height:1.45;}
  </style>
</head>
<body>
  <div class="wrap" id="app" data-theme="dark">
    <header>
      <div>
        <h1>ğŸš¦ ë§ˆê° ìœ„í—˜ë„ ê³„ì‚°ê¸°</h1>
        <p class="sub">
          ì…ë ¥ì€ 4ê°œë§Œ: <b>ë§ˆê°ì¼</b>, <b>ëª©í‘œ</b>, <b>ê¸°ì¡´ ì‘ì—…ëŸ‰</b>, <b>ì˜¤ëŠ˜ ì‘ì—…ëŸ‰</b>.<br/>
          â€œì˜ˆìƒ ì™„ì£¼ì¼â€ì€ <b>ì˜¤ëŠ˜ ì‘ì—…ëŸ‰ì„ ë§¤ì¼ ìœ ì§€í•œë‹¤ê³  ê°€ì •</b>í•œ ì˜ˆì¸¡ì´ì—ìš”.
        </p>
      </div>
      <div class="toggleRow">
        <button class="btn" id="themeBtn">ğŸŒ™ ë‹¤í¬ëª¨ë“œ</button>
        <button class="btn" id="resetBtn">â†º ì´ˆê¸°í™”</button>
      </div>
    </header>

    <div class="grid">
      <section class="card">
        <h2>ì…ë ¥</h2>

        <div class="field">
          <label for="deadline">ë§ˆê°ì¼</label>
          <input id="deadline" type="date" />
          <div class="hint">ì˜¤ëŠ˜ ê¸°ì¤€ìœ¼ë¡œ D-day ê³„ì‚°. (ë§ˆê°ì¼ì´ ì˜¤ëŠ˜ì´ë©´ D-0)</div>
        </div>

        <div class="field">
          <label for="goal">ëª©í‘œ (ì)</label>
          <input id="goal" type="number" min="0" step="1" placeholder="ì˜ˆ: 300000" />
        </div>

        <div class="field">
          <label for="base">ê¸°ì¡´ ì‘ì—…ëŸ‰ (ì) â€” ì™„ì „ì›ê³ /ëˆ„ì  ë“±</label>
          <input id="base" type="number" min="0" step="1" placeholder="ì˜ˆ: 230000" />
        </div>

        <div class="field">
          <label for="today">ì˜¤ëŠ˜ ì‘ì—…ëŸ‰ (ì)</label>
          <input id="today" type="number" min="0" step="1" placeholder="ì˜ˆ: 1593" />
          <div class="hint">ì˜¤ëŠ˜ ì‘ì—…ëŸ‰ì€ â€œí•©ê³„â€ì— í¬í•¨ë˜ì–´ ì§„í–‰ë¥ /ë‚¨ì€ ë¶„ëŸ‰ê¹Œì§€ ì „ë¶€ ê°±ì‹ ë©ë‹ˆë‹¤.</div>
        </div>

        <div class="field">
          <label for="memo">ë©”ëª¨</label>
          <textarea id="memo" placeholder="ì˜ˆ: ì˜¤ëŠ˜ì€ ì¸ë¬¼ ì‹¬ë¦¬ì—ì„œ ë§‰í˜ / ë‚´ì¼ì€ 4,000ì ì´ìƒ"></textarea>
          <div class="hint">ë©”ëª¨ëŠ” ë¡œì»¬ ì €ì¥(ë¸Œë¼ìš°ì €ì— ì €ì¥)ë¼ì„œ ìƒˆë¡œê³ ì¹¨í•´ë„ ì‚´ì•„ìˆì–´ìš”.</div>
        </div>
      </section>

      <section class="card">
        <h2>ê²°ê³¼</h2>

        <!-- 4ë²ˆ ì¹©: ê²°ê³¼ ìƒë‹¨ -->
        <div class="diag">
          <span class="dot" id="diagDot"></span>
          <span class="chip" id="diagChip">ì§„ë‹¨: -</span>
          <span class="chip mono" id="ddayChip">D-day: -</span>
          <span class="chip mono" id="paceChip">ì†ë„: -</span>
        </div>

        <div class="kpi">
          <div class="tile">
            <div class="t">ê¸°ì¡´ ì‘ì—…ëŸ‰</div>
            <div class="v"><span id="vBase">-</span><span class="t">ì</span></div>
          </div>
          <div class="tile">
            <div class="t">ì˜¤ëŠ˜ ì‘ì—…ëŸ‰</div>
            <div class="v"><span id="vToday">-</span><span class="t">ì</span></div>
          </div>
          <div class="tile">
            <div class="t">í•©ê³„</div>
            <div class="v"><span id="vTotal">-</span><span class="t">ì</span></div>
          </div>
          <div class="tile">
            <div class="t">ì§„í–‰ë¥ </div>
            <div class="v"><span id="vPct">-</span><span class="t">%</span></div>
            <div class="barWrap"><div class="bar" id="bar"></div></div>
          </div>

          <div class="tile">
            <div class="t">ëª©í‘œ</div>
            <div class="v"><span id="vGoal">-</span><span class="t">ì</span></div>
          </div>
          <div class="tile">
            <div class="t">ë‚¨ì€ ë¶„ëŸ‰</div>
            <div class="v"><span id="vRemain">-</span><span class="t">ì</span></div>
          </div>

          <div class="tile">
            <div class="t">ë§ˆê°ì¼ê¹Œì§€</div>
            <div class="v"><span id="vDaysLeft">-</span><span class="t">ì¼</span></div>
          </div>
          <div class="tile">
            <div class="t">í•„ìš” ì¼ì¼ ì‘ì—…ëŸ‰</div>
            <div class="v"><span id="vNeedPerDay">-</span><span class="t">ì/ì¼</span></div>
          </div>
        </div>

        <div class="row2">
          <div class="tile">
            <div class="t">ì˜ˆìƒ ì™„ì£¼ì¼</div>
            <div class="v"><span id="vFinish">-</span></div>
            <div class="hint" id="finishHint">* ì˜¤ëŠ˜ ì‘ì—…ëŸ‰ì„ ë§¤ì¼ ìœ ì§€í•œë‹¤ê³  ê°€ì •í•œ ë‹¨ìˆœ ì˜ˆì¸¡ì´ì—ìš”.</div>
          </div>

          <div class="alertBox" id="alertBox">
            <div class="alertTitle">ì•Œë¦¼</div>
            <p class="alertText" id="vNote">-</p>
            <div class="alertSub" id="noteSub">-</div>
          </div>
        </div>

        <div class="small" id="foot">
          ì§„ë‹¨ ê·œì¹™(ì˜¤ëŠ˜ ì†ë„ ê¸°ì¤€): ratio = (ì˜¤ëŠ˜ ì‘ì—…ëŸ‰ Ã— ë‚¨ì€ ë‚ ì§œ) / ë‚¨ì€ ë¶„ëŸ‰<br/>
          â€¢ ratio â‰¥ 1.15 â†’ âœ… ì•ˆì „ / ratio â‰¥ 0.90 â†’ âš ï¸ ì£¼ì˜ / ê·¸ ë¯¸ë§Œ â†’ ğŸš¨ ìœ„í—˜
        </div>
      </section>
    </div>
  </div>

  <script>
    const $ = (id) => document.getElementById(id);

    function n(v){ const x = Number(v); return Number.isFinite(x) ? x : 0; }
    function fmtInt(x){ return Math.round(x).toLocaleString("ko-KR"); }
    function clamp(v, a, b){ return Math.max(a, Math.min(b, v)); }

    function parseDate(s){
      if(!s) return null;
      const [y,m,d] = s.split("-").map(Number);
      if(!y||!m||!d) return null;
      return new Date(y, m-1, d);
    }
    function startOfDay(dt){ return new Date(dt.getFullYear(), dt.getMonth(), dt.getDate()); }
    function addDays(dt, days){ const x = new Date(dt); x.setDate(x.getDate() + days); return x; }
    function ymd(dt){
      const y = dt.getFullYear();
      const m = String(dt.getMonth()+1).padStart(2,"0");
      const d = String(dt.getDate()).padStart(2,"0");
      return `${y}-${m}-${d}`;
    }

    const app = $("app");
    const themeBtn = $("themeBtn");
    const resetBtn = $("resetBtn");

    const inp = {
      deadline: $("deadline"),
      goal: $("goal"),
      base: $("base"),
      today: $("today"),
      memo: $("memo"),
    };

    const out = {
      diagChip: $("diagChip"),
      diagDot: $("diagDot"),
      ddayChip: $("ddayChip"),
      paceChip: $("paceChip"),

      vGoal: $("vGoal"),
      vBase: $("vBase"),
      vToday: $("vToday"),
      vTotal: $("vTotal"),
      vPct: $("vPct"),
      bar: $("bar"),

      vRemain: $("vRemain"),
      vDaysLeft: $("vDaysLeft"),
      vNeedPerDay: $("vNeedPerDay"),
      vFinish: $("vFinish"),
      finishHint: $("finishHint"),

      vNote: $("vNote"),
      noteSub: $("noteSub"),
    };

    const KEY = "deadline_calc_v2_today_based";
    function load(){
      try{
        const raw = localStorage.getItem(KEY);
        if(!raw) return;
        const s = JSON.parse(raw);
        if(s.theme) app.setAttribute("data-theme", s.theme);
        if(s.deadline) inp.deadline.value = s.deadline;
        if(s.goal != null) inp.goal.value = s.goal;
        if(s.base != null) inp.base.value = s.base;
        if(s.today != null) inp.today.value = s.today;
        if(s.memo != null) inp.memo.value = s.memo;
      }catch(e){}
      syncThemeBtn();
    }
    function save(){
      const s = {
        theme: app.getAttribute("data-theme"),
        deadline: inp.deadline.value || "",
        goal: inp.goal.value || "",
        base: inp.base.value || "",
        today: inp.today.value || "",
        memo: inp.memo.value || "",
      };
      localStorage.setItem(KEY, JSON.stringify(s));
    }
    function syncThemeBtn(){
      const t = app.getAttribute("data-theme");
      themeBtn.textContent = (t === "light") ? "ğŸŒ™ ë‹¤í¬ëª¨ë“œ" : "â˜€ï¸ ë¼ì´íŠ¸ëª¨ë“œ";
    }

    function compute(){
      const goal = n(inp.goal.value);
      const base = n(inp.base.value);
      const today = n(inp.today.value);

      const total = base + today;
      const remain = Math.max(goal - total, 0);

      const now = startOfDay(new Date());
      const dl = parseDate(inp.deadline.value);

      let daysLeft = null;
      if(dl){
        daysLeft = Math.round((startOfDay(dl).getTime() - now.getTime()) / (1000*60*60*24));
      }

      const needPerDay = (daysLeft !== null && daysLeft > 0)
        ? (remain / daysLeft)
        : (remain > 0 ? Infinity : 0);

      // ì˜ˆìƒ ì™„ì£¼ì¼: ì˜¤ëŠ˜ ì‘ì—…ëŸ‰ì„ ë§¤ì¼ ìœ ì§€í•œë‹¤ê³  ê°€ì •
      let finish = "-";
      let finishDate = null;
      if(goal <= 0){
        finish = "-";
      } else if(remain === 0){
        finish = "ì™„ë£Œ";
      } else if(today <= 0){
        finish = "âˆ";
      } else {
        const daysToFinish = Math.ceil(remain / today);
        finishDate = addDays(now, daysToFinish);
        finish = ymd(finishDate);
      }

      let dText = "-";
      if(daysLeft !== null){
        dText = (daysLeft >= 0) ? `D-${daysLeft}` : `D+${Math.abs(daysLeft)}`;
      }

      // ratio = (today*daysLeft)/remain
      let ratio = 0;
      if(remain === 0){
        ratio = 999;
      } else if(daysLeft === null || daysLeft <= 0){
        ratio = 0;
      } else {
        ratio = (today * daysLeft) / remain;
      }

      let level="â€¢", label="-", note="-", noteColor="var(--muted)";

      if(goal <= 0 || !dl){
        level="âš ï¸"; label="ì„¤ì •í•„ìš”"; note="ë§ˆê°ì¼/ëª©í‘œë¥¼ ë¨¼ì € ë„£ì–´ ì£¼ì„¸ìš”."; noteColor="var(--warn)";
      } else if(remain === 0){
        level="âœ…"; label="ì™„ë£Œ"; note="ë. ì™„ì£¼. ìŠ¹ë¦¬."; noteColor="var(--good)";
      } else if(daysLeft !== null && daysLeft < 0){
        level="ğŸš¨"; label="ê¸°í•œì´ˆê³¼"; note="ë§ˆê°ì´ ì´ë¯¸ ì§€ë‚¬ì–´ìš”."; noteColor="var(--bad)";
      } else if(daysLeft === 0){
        level="ğŸš¨"; label="ì˜¤ëŠ˜ ë§ˆê°"; note="ì˜¤ëŠ˜ì´ ë§ˆê°ì¸ë° ì•„ì§ ë‚¨ì•˜ì–´ìš”."; noteColor="var(--bad)";
      } else if(today <= 0){
        level="ğŸš¨"; label="ìœ„í—˜"; note="ì˜¤ëŠ˜ ì‘ì—…ëŸ‰ì´ 0ì´ë©´, ì˜ˆìƒ ì™„ì£¼ì¼ì€ âˆê°€ ë©ë‹ˆë‹¤."; noteColor="var(--bad)";
      } else {
        if (ratio >= 1.15) { level="âœ…"; label="ì•ˆì „"; note="í˜„ì¬ ì†ë„ë©´ ì—¬ìœ ê°€ ìˆì–´ìš”."; noteColor="var(--good)"; }
        else if (ratio >= 0.90) { level="âš ï¸"; label="ì£¼ì˜"; note="ì§€ê¸ˆ ì†ë„ë©´ ì•„ìŠ¬ì•„ìŠ¬í•´ìš”."; noteColor="var(--warn)"; }
        else { level="ğŸš¨"; label="ìœ„í—˜"; note="í˜„ì¬ ì†ë„ë©´ ë§ˆê°ì´ ê¹¨ì§ˆ ê°€ëŠ¥ì„±ì´ ì»¤ìš”."; noteColor="var(--bad)"; }
      }

      let sub = "";
      if(finishDate && dl){
        const lateDays = Math.round((startOfDay(finishDate).getTime() - startOfDay(dl).getTime()) / (1000*60*60*24));
        if(lateDays > 0){
          sub = `ì˜ˆìƒ ì™„ì£¼ì¼ì´ ë§ˆê°ì¼ë³´ë‹¤ <b>${lateDays}ì¼</b> ëŠ¦ì–´ìš”. (ìŠ¬í”” ê°ì§€ ğŸ¥²)`;
          if(level !== "âœ…") noteColor = "var(--bad)";
        } else {
          sub = `ì˜ˆìƒ ì™„ì£¼ì¼ì´ ë§ˆê°ì¼ë³´ë‹¤ <b>${Math.abs(lateDays)}ì¼</b> ë¹¨ë¼ìš”.`;
        }
      } else if(finish === "âˆ"){
        sub = `ì˜¤ëŠ˜ ì†ë„ê°€ 0ì´ë¼ì„œ ì˜ˆìƒ ì™„ì£¼ì¼ì´ ë¬´í•œëŒ€ë¡œ ë– ìš”.`;
      } else if(!dl){
        sub = `ë§ˆê°ì¼ì„ ë„£ìœ¼ë©´ D-day/í•„ìš” ì†ë„/ìŠ¬í”” íŒì •ì´ ì‚´ì•„ë‚˜ìš”.`;
      } else {
        sub = `ì˜¤ëŠ˜ ì†ë„ë¥¼ ë°”ê¾¸ë©´ ì˜ˆìƒ ì™„ì£¼ì¼ì´ ë°”ë¡œ ì›€ì§ì—¬ìš”.`;
      }

      out.vGoal.textContent = goal ? fmtInt(goal) : "-";
      out.vBase.textContent = fmtInt(base);
      out.vToday.textContent = fmtInt(today);
      out.vTotal.textContent = fmtInt(total);
      out.vRemain.textContent = goal ? fmtInt(remain) : "-";
      out.vDaysLeft.textContent = (daysLeft === null) ? "-" : String(daysLeft);

      out.vNeedPerDay.textContent = (!goal || daysLeft === null)
        ? "-"
        : (needPerDay === Infinity ? "âˆ" : fmtInt(needPerDay));

      const pct = (goal > 0) ? (total / goal * 100) : 0;
      const pctShown = (goal > 0) ? clamp(pct, 0, 999) : 0;
      out.vPct.textContent = (goal > 0) ? pctShown.toFixed(1) : "-";
      out.bar.style.width = (goal > 0) ? clamp(pct, 0, 100).toFixed(1) + "%" : "0%";

      out.ddayChip.textContent = `D-day: ${dText}`;
      out.paceChip.textContent = `ì†ë„: ${today ? fmtInt(today) : 0}ì/ì¼`;

      out.vFinish.textContent = finish;
      out.finishHint.innerHTML = `* â€œì˜¤ëŠ˜ ì‘ì—…ëŸ‰(<b>${fmtInt(today)}</b>ì/ì¼)â€ì„ ë§¤ì¼ ìœ ì§€í•œë‹¤ê³  ê°€ì •í•œ ë‹¨ìˆœ ì˜ˆì¸¡ì´ì—ìš”.`;

      out.diagChip.textContent = `ì§„ë‹¨: ${level} ${label}`;
      out.diagChip.style.borderColor = noteColor;
      out.diagDot.style.background = noteColor;

      out.vNote.textContent = note;
      out.vNote.style.color = noteColor;
      out.noteSub.innerHTML = sub;

      save();
    }

    function toggleTheme(){
      const cur = app.getAttribute("data-theme");
      app.setAttribute("data-theme", cur === "light" ? "dark" : "light");
      syncThemeBtn();
      save();
    }
    function resetAll(){
      localStorage.removeItem(KEY);
      inp.deadline.value = "";
      inp.goal.value = "";
      inp.base.value = "";
      inp.today.value = "";
      inp.memo.value = "";
      app.setAttribute("data-theme", "dark");
      syncThemeBtn();
      compute();
    }

    themeBtn.addEventListener("click", () => { toggleTheme(); compute(); });
    resetBtn.addEventListener("click", resetAll);

    Object.values(inp).forEach(el => {
      el.addEventListener("input", compute);
      el.addEventListener("change", compute);
    });

    load();
    compute();
  </script>
</body>
</html>
